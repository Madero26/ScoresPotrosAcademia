<!doctype html><html lang="es"><head>
  <%- include('../../../partials/headAdmin') %>
  <link rel="stylesheet" href="/resources/styles/styleFormsAdmins.css">
</head><body>
  <%- include('../../../partials/navbar_adminEstadisticas') %>

  <main class="container">
    <h1>Editar estad√≠sticas del equipo</h1>

    <div class="card">
      <div class="form-grid">
        <div class="form-group">
          <label>Equipo</label>
          <select id="selEq" class="input">
            <option value="">Selecciona</option>
            <% (equipos||[]).forEach(e=>{ %>
              <option value="<%= e.id_equipo_temporada %>"><%= e.nombre %></option>
            <% }) %>
          </select>
        </div>
      </div>

      <form method="POST" action="/adminEstadisticas/StatsEditarEstadisticaEquipo">
        <input type="hidden" name="id_equipo_temporada" id="id_eq">
        <div class="form-grid">
          <div class="form-group"><label>CA favor</label><input class="input" name="carreras_a_favor"   type="number" min="0" value="0"></div>
          <div class="form-group"><label>CA contra</label><input class="input" name="carreras_en_contra" type="number" min="0" value="0"></div>
          <div class="form-group"><label>Ganados</label><input class="input" name="ganados"   type="number" min="0" value="0"></div>
          <div class="form-group"><label>Perdidos</label><input class="input" name="perdidos"  type="number" min="0" value="0"></div>
          <div class="form-group"><label>Empatados</label><input class="input" name="empatados" type="number" min="0" value="0"></div>
          <div class="form-group"><label>Errores</label><input class="input" name="errores"    type="number" min="0" value="0"></div>
        </div>

        <div class="form-actions">
          <button class="btn btn-primary" type="submit" id="btnSave" disabled>Guardar</button>
          <a class="btn btn-outline" href="/adminEstadisticas">Cancelar</a>
        </div>
      </form>
    </div>
  </main>

  <script>
    const selEq=document.getElementById('selEq');
    const id_eq=document.getElementById('id_eq');
    const btn=document.getElementById('btnSave');

    selEq.addEventListener('change', async ()=>{
      id_eq.value = selEq.value || '';
      btn.disabled = !selEq.value;
      if(!selEq.value) return;
      const r = await fetch(`/adminEstadisticas/ajax/equipoStats?id_equipo_temporada=${selEq.value}`);
      const js = await r.json() || {};
      const set = (name,val)=>{ const el=document.querySelector(`[name="${name}"]`); if(el) el.value = Number(val||0); };
      set('carreras_a_favor',   js.carreras_a_favor);
      set('carreras_en_contra', js.carreras_en_contra);
      set('ganados',            js.ganados);
      set('perdidos',           js.perdidos);
      set('empatados',          js.empatados);
      set('errores',            js.errores);
    });
  </script>
  <!-- Mensajes -->
<script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
<% if (typeof alert !== 'undefined' && alert) { %>
<script>
  Swal.fire({
    title: <%- JSON.stringify(alertTitle) %>,
    text:  <%- JSON.stringify(alertMessage) %>,
    icon:  <%- JSON.stringify(alertIcon) %>,
    showConfirmButton: <%- JSON.stringify(showConfirmButton) %>,
    timer: <%- (timer==null?'null':Number(timer)) %>
  }).then(() => {
    <% if (ruta) { %> location.href = <%- JSON.stringify(ruta) %>; <% } %>
  });
</script>
<% } %>

</body></html>
